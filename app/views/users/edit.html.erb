<div class="container max_924">

<div class="row">
  <div class="col-md-12">
    <h2 class="text-din text-center" style="padding-bottom: 40px;">MEET</h2>
  </div>
</div>

<div class="row" style="padding-bottom: 40px;border-bottom: 1px solid #c0c0c0;margin-bottom: 20px;">
  <div class="col-md-6">
    <div class="row">
      <% if @user.picture_url %>
        <div class="col-sm-4">
          <img src="<%= @user.picture_url %>" style="height:141px;width:141px;background-color:#ef4747;">
        </div>
      <% end %>
      <div class="col-sm-8" class="text-din">
        <div class="text-uppercase">HI <%= @user.name %></div>
        <p>Please enter your postcode.  We need this to find your local MP.<p>
        <%= form_tag add_post_code_join_constituency_user_path(current_user), id: "add_postcode", remote: true do %>
          <div class="form-group">
             <%= text_field_tag :postcode, @user.post_code, class:'form-control' %>
               </div>
              <%# submit_tag 'submit', id: "postcode_check" %>
              <div class="form-group">
         <%= button_tag(type: 'submit', id: "postcode_check", class: "btn btn-default") do %>
           <i class="fa fa-map-marker"></i> Submit
         <% end %>
         </div>

        <% end %>
      </div>
    </div>
  </div>
  <div class="col-md-6">
    <div class="row">

      <div class="col-sm-4">
        <img src="<%= @mp.picture_url if @mp && @mp.picture_url %>" style="height:141px;width:141px;background-color:#10b8b8;">

      </div>
      <div class="col-sm-8">
        <div class="text-uppercase"><%= @mp.name if @mp %></div>
        <div>MP for <%= @constituency.name if @constituency %>
        Send message <br/>
        FB TW EM<br/>
        Phone
      </div>
    </div>
  </div>
</div>
</div>

<div class="row" style="padding-bottom: 20px;border-bottom: 1px solid #c0c0c0;margin-bottom: 20px;">
  <div class="col-md-12 text-center">
    <h4 class="text-din text-center" style="padding-bottom: 40px;">PICK YOUR PARTY</h4>
    <% 
      if @parties.any? 
      @parties.each do |party|
    %>
      <p style="display:inline;padding: 15px;line-height: 2.5em;"><a href="javascript:;" class="add_user_to_party_link text-din text-uppercase" id="<%= party.id %>"><%= party.name %></a></p>
    <% end %>
    <% end %>
    <div style="clear:both;"></div>
    <div style="display:none;">
      <%= form_tag add_user_to_party_user_path(@user), id: "add_party" do %>
        <%= hidden_field_tag :party_name, "" %>
      <% end %>
    </div>
  </div>
</div>

<div class="row"  style="padding-bottom:60px;">
  <div class="col-md-12">
    <h4 class="text-din text-center" style="padding-bottom: 40px;">EDIT ACCOUNT INFORMATION</h4>
      <%= form_for(@user, :url => { :action => "update_info" } ) do |f| %>
        <div class="field form-group">
          <%= f.label :password, "Password" %>
          <%= f.password_field :password, :autocomplete => "off", :class => 'form-control'  %>
        </div>
        <div class="field form-group">
          <%= f.label :password_confirmation %>
          <%= f.password_field :password_confirmation, :class => 'form-control' %>
        </div>
        <div class="field form-group">
          <%= f.label :allow_profile_view %>
          <%= f.check_box :allow_profile_view %>
        </div>
        <div class="action_container form-group">
             <%# f.submit %>
			<%= button_tag(type: 'submit', class: "btn btn-outline btn-square") do %>
           		<i class="fa fa-user"></i> Update User
         	<% end %>
        </div>
      <% end %>

      <%= form_for(@user, :url => { :action => "update_info" } ) do |f| %>
        <div class="field form-group">
          <h4 class="text-din">ABOUT YOU</h4>
        </div>
        <div class="field form-group">
          <%= f.text_area :bio, :class => 'form-control text-din', placeholder: "ENTER YOUR BIO"  %>
        </div>
        <div class="field form-group">
          <h4 class="text-din">SOCIAL MEDIA LINKS</h4>
        </div>
        <div class="row">
        	<div class="col-sm-6">
				<div class="field form-group">
				  <%= f.text_field :fb_link, :class => 'form-control text-din', placeholder: "FACEBOOK"  %>
				</div>
			</div>
			<div class="col-sm-6">
				<div class="field form-group">
				  <%= f.text_field :tw_link, :class => 'form-control text-din', placeholder: "TWITTER"  %>
				</div>
			</div>
		</div>
        <div class="row">
        	<div class="col-sm-6">
				<div class="field form-group">
				  <%= f.text_field :insta_link, :class => 'form-control text-din', placeholder: "INSTAGRAM"  %>
				</div>
			</div>
			<div class="col-sm-6">
				<div class="field form-group">
				  <%= f.text_field :youtube_link, :class => 'form-control text-din', placeholder: "YOUTUBE"  %>
				</div>
			</div>
		</div>
        <div class="field form-group">
          <%= f.text_field :web_link, :class => 'form-control text-din', placeholder: "WEBSITE"  %>
        </div>
        <div class="field form-group">
          <h4 class="text-din">ADDRESS</h4>
        </div>
        <div class="field form-group">
          <%= f.text_field :street_addr, :class => 'form-control text-din', placeholder: "STREET"  %>
        </div>
        <div class="row">
        	<div class="col-sm-6">
				<div class="field form-group">
				  <%= f.text_field :city, :class => 'form-control text-din', placeholder: "CITY"  %>
				</div>
			</div>
			<div class="col-sm-6">
				<div class="field form-group">
				  <%= f.text_field :post_code, :class => 'form-control text-din', placeholder: "POSTCODE", disabled: true  %>
				</div>
			</div>
		</div>
        <div class="field form-group">
          <%= f.text_field :phone, :class => 'form-control text-din', placeholder: "PHONE (OPTIONAL)"  %>
        </div>
        <div class="action_container clearfix">
        	<div class="pull-right">
          <%# f.submit %>
			<%= button_tag(type: 'submit', class: "btn btn-outline text-uppercase btn-square") do %>
           		<i class="fa fa-floppy-o"></i> Save Details
         	<% end %>
         	</div>
        </div>
      <% end %>




      <div style="display:none;">
        <div class="form-group">
          <% unless @idents.include?("twitter") %>
           <a href="<%= root_url %>users/auth/twitter" class="btn btn-default"><i class="fa fa-twitter"></i> MERGE TWITTER</a>
          <% else %>
           <a href="<%= remove_twitter_users_path %>" class="btn btn-default"><i class="fa fa-twitter"></i> REMOVE TWITTER FROM ACCOUNT</a>
          <% end %>

          <% unless @idents.include?("facebook") %>
             <a href="<%= root_url %>users/auth/facebook" class="btn btn-default"><i class="fa fa-facebook"></i> MERGE FACEBOOK</a>
          <% else %>
           <a href="<%= remove_twitter_users_path %>" class="btn btn-default"><i class="fa fa-facebook"></i> REMOVE FACEBOOK FROM ACCOUNT</a>
          <% end %>
      </div>
     </div>
     <div class="form-group" style="padding-top:12px;">
      <%# would like to add html to this button --> <i class="fa fa-user-times"></i>  %>
      <%= button_to 'Cancel my account'.html_safe, registration_path(resource_name), data: { confirm: "Are you sure?" }, method: :delete, class:'btn btn-default btn-square' %>
     </div>

  </div>
</div>

</div><!--.container max_924-->

<script type="text/javascript">
function testPostCode () {
  var newPostCode = checkPostCode  (document.getElementById('postcode').value);
  if (newPostCode) {
    document.getElementById('postcode').value = newPostCode;
    $('#add_postcode').trigger("submit.rails");
  } 
  else alert ("Postcode has invalid format");
}
$('body').off('click','#postcode_check');
$('body').on('click','#postcode_check', function(e){
  e.preventDefault();
  testPostCode();
});
</script>

<script type="text/javascript">
var ready;
ready = function() {

$('body').off('click','.add_user_to_party_link');
$('body').on('click','.add_user_to_party_link', function(e){
  e.preventDefault();

  var _this = $(this).text();
  $('#party_name').val(_this);
  $('#add_party').trigger("submit.rails");


});

<% if @user.party_id %>
    $('.add_user_to_party_link#' + <%= @user.party_id %>).css({color: '#ef4747', border: '1px solid #333', padding: '5px 10px'});
<% end %>
};

$(document).ready(ready);
$(document).on('page:load', ready);
</script>